# config for training GPT-2 (124M) down to very nice loss of ~2.85 on 1 node of 8X A100 40GB
# launch as the following (e.g. in a screen session) and wait ~5 days:
# $ torchrun --standalone --nproc_per_node=8 train.py config/train_gpt2.py

# Model size
n_layer = 12
n_head = 12
n_embd = 768
model_type = 'AdaLN6_NoRep_cond_128_trunc_qknorm'

# I/O
out_dir = 'order_ckpt/124M-order2'
wandb_log = True
wandb_project = 'AOGPT'
wandb_run_name= 'AOGPT-124M-order2'

# Bias
bias = True

# Dropout
dropout = 0.0

# EMA
ema_rate = 1 - 1e-4

# weight decay
weight_decay = 5e-2

# beta2
beta2 = 0.95

# these make the total batch size be ~0.5M
# 32 batch size * 1024 block size * 2 gradaccum * 8 GPUs = 524,288
batch_size = 32
block_size = 1024
gradient_accumulation_steps = 2*8

# this makes total number of tokens be 500B
learning_rate = 6e-4
max_iters = 20000
lr_decay_iters = 500000

# eval stuff
eval_interval = 1000
save_interval = 10000
eval_iters = 96
log_interval = 10


order = [201, 296, 500, 305, 782, 462, 811, 68, 378, 732, 484, 545, 658, 789, 198, 326, 490, 933, 33, 616, 711, 82, 1008, 763, 779, 499, 23, 50, 492, 949, 265, 85, 670, 553, 627, 757, 675, 134, 671, 121, 432, 927, 32, 443, 899, 216, 536, 359, 953, 477, 63, 213, 810, 113, 304, 718, 144, 135, 348, 465, 844, 418, 344, 575, 493, 573, 447, 364, 606, 502, 108, 412, 365, 46, 560, 497, 570, 11, 849, 371, 48, 293, 561, 715, 742, 300, 272, 473, 362, 1023, 690, 640, 19, 703, 421, 273, 904, 209, 379, 172, 14, 445, 25, 24, 303, 698, 9, 840, 728, 614, 797, 582, 417, 960, 70, 751, 438, 936, 618, 155, 413, 145, 211, 137, 907, 128, 388, 495, 820, 351, 157, 903, 652, 962, 212, 535, 750, 338, 234, 29, 118, 809, 579, 56, 685, 35, 567, 704, 973, 146, 651, 843, 731, 177, 149, 90, 34, 386, 245, 60, 167, 942, 178, 307, 436, 696, 126, 509, 489, 345, 913, 468, 290, 845, 687, 864, 49, 258, 187, 991, 817, 572, 850, 812, 91, 846, 944, 762, 168, 12, 37, 325, 759, 533, 141, 796, 439, 463, 269, 1013, 80, 266, 451, 15, 353, 825, 969, 170, 686, 132, 565, 511, 101, 21, 964, 937, 156, 821, 426, 752, 957, 7, 766, 586, 419, 938, 241, 920, 680, 860, 679, 664, 1020, 501, 851, 566, 714, 805, 38, 39, 525, 516, 278, 239, 716, 44, 404, 914, 746, 361, 595, 724, 218, 330, 853, 270, 814, 710, 708, 824, 894, 547, 130, 720, 315, 681, 826, 661, 133, 275, 314, 841, 772, 970, 880, 210, 989, 347, 753, 280, 798, 925, 423, 589, 872, 619, 74, 568, 65, 261, 313, 747, 935, 433, 0, 6, 309, 939, 214, 512, 97, 335, 963, 116, 916, 802, 775, 801, 1015, 613, 352, 289, 3, 189, 47, 69, 420, 226, 382, 143, 119, 829, 474, 918, 996, 405, 780, 151, 869, 623, 366, 36, 411, 194, 88, 730, 978, 115, 702, 389, 815, 725, 786, 1006, 787, 774, 990, 84, 790, 173, 737, 578, 563, 867, 346, 975, 179, 429, 40, 478, 895, 760, 639, 488, 818, 554, 532, 866, 544, 350, 521, 409, 596, 312, 93, 633, 448, 467, 847, 440, 469, 827, 837, 243, 882, 694, 235, 96, 161, 441, 608, 59, 831, 377, 174, 968, 977, 100, 498, 268, 450, 308, 281, 430, 816, 225, 169, 879, 858, 764, 947, 182, 723, 322, 876, 367, 594, 878, 95, 634, 636, 107, 456, 984, 669, 158, 109, 839, 224, 891, 244, 934, 183, 600, 99, 98, 754, 803, 701, 205, 997, 139, 185, 952, 832, 800, 531, 274, 609, 615, 649, 655, 120, 1001, 738, 908, 663, 184, 1007, 966, 197, 549, 699, 605, 515, 61, 480, 482, 986, 416, 848, 75, 202, 741, 457, 982, 217, 928, 20, 422, 955, 807, 452, 898, 276, 629, 884, 666, 665, 18, 311, 791, 788, 558, 905, 152, 514, 859, 267, 64, 397, 559, 393, 72, 233, 504, 181, 138, 910, 407, 503, 186, 897, 662, 783, 227, 342, 599, 30, 954, 117, 555, 721, 228, 552, 622, 402, 81, 976, 912, 372, 673, 773, 111, 875, 922, 987, 948, 906, 959, 355, 150, 518, 163, 376, 653, 52, 283, 892, 385, 127, 862, 259, 54, 327, 191, 66, 55, 804, 598, 870, 434, 556, 92, 358, 104, 255, 756, 823, 453, 706, 67, 637, 242, 946, 287, 277, 958, 657, 926, 316, 591, 735, 593, 597, 442, 494, 285, 479, 736, 408, 863, 384, 517, 684, 755, 399, 768, 343, 588, 644, 893, 896, 697, 562, 612, 271, 406, 446, 808, 190, 877, 336, 288, 123, 200, 522, 215, 994, 8, 374, 581, 291, 199, 1016, 1021, 207, 329, 470, 17, 624, 632, 678, 940, 248, 395, 583, 31, 461, 1005, 758, 53, 998, 147, 727, 538, 262, 246, 691, 232, 995, 370, 341, 357, 617, 455, 5, 299, 110, 491, 102, 932, 449, 301, 1014, 124, 203, 979, 323, 298, 761, 192, 871, 320, 148, 778, 924, 71, 263, 729, 510, 795, 240, 668, 230, 256, 784, 231, 647, 391, 943, 428, 122, 415, 965, 45, 1004, 466, 164, 302, 324, 777, 204, 749, 306, 229, 481, 707, 485, 813, 154, 793, 220, 776, 819, 188, 635, 520, 881, 744, 836, 222, 855, 425, 857, 1018, 223, 557, 380, 693, 767, 206, 695, 472, 373, 792, 734, 360, 585, 659, 930, 140, 475, 660, 369, 332, 542, 945, 980, 257, 743, 971, 648, 105, 961, 238, 524, 195, 193, 1019, 886, 486, 383, 180, 569, 286, 834, 458, 828, 603, 630, 77, 733, 219, 250, 705, 114, 26, 459, 349, 911, 985, 541, 534, 854, 237, 471, 785, 196, 806, 337, 279, 974, 254, 4, 410, 835, 22, 919, 476, 1, 236, 641, 319, 543, 431, 868, 363, 602, 683, 131, 1017, 921, 251, 86, 392, 546, 427, 153, 414, 58, 375, 676, 103, 587, 983, 16, 94, 726, 1012, 611, 334, 1002, 496, 873, 781, 175, 909, 1009, 394, 677, 10, 625, 387, 646, 580, 284, 424, 401, 667, 719, 856, 57, 106, 577, 650, 89, 689, 539, 654, 27, 564, 159, 403, 739, 601, 437, 339, 765, 822, 505, 771, 87, 1010, 519, 464, 43, 444, 112, 142, 981, 28, 592, 621, 883, 967, 318, 79, 656, 610, 645, 941, 740, 688, 398, 604, 528, 331, 381, 631, 956, 709, 523, 390, 548, 571, 310, 129, 527, 282, 770, 264, 628, 529, 208, 297, 574, 1003, 537, 607, 692, 993, 460, 915, 626, 252, 400, 799, 340, 885, 950, 830, 951, 576, 988, 83, 638, 13, 889, 902, 62, 992, 328, 838, 51, 700, 929, 136, 368, 642, 171, 1022, 253, 165, 317, 221, 162, 874, 717, 483, 249, 294, 794, 354, 674, 435, 513, 321, 125, 506, 917, 923, 852, 769, 888, 672, 712, 76, 176, 620, 333, 507, 713, 931, 526, 972, 550, 166, 356, 508, 861, 247, 396, 292, 73, 1000, 42, 530, 901, 260, 551, 590, 540, 454, 745, 295, 584, 890, 78, 833, 41, 865, 682, 748, 487, 900, 643, 2, 1011, 999, 722, 887, 842, 160]