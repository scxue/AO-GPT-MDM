# config for training GPT-2 (124M) down to very nice loss of ~2.85 on 1 node of 8X A100 40GB
# launch as the following (e.g. in a screen session) and wait ~5 days:
# $ torchrun --standalone --nproc_per_node=8 train.py config/train_gpt2.py

# Model size
n_layer = 12
n_head = 12
n_embd = 768
model_type = 'AdaLN6_NoRep_cond_128_trunc_qknorm'

# I/O
out_dir = 'order_ckpt/124M-order1'
wandb_log = True
wandb_project = 'AOGPT'
wandb_run_name= 'AOGPT-124M-order1'

# Bias
bias = True

# Dropout
dropout = 0.0

# EMA
ema_rate = 1 - 1e-4

# weight decay
weight_decay = 5e-2

# beta2
beta2 = 0.95

# these make the total batch size be ~0.5M
# 32 batch size * 1024 block size * 2 gradaccum * 8 GPUs = 524,288
batch_size = 32
block_size = 1024
gradient_accumulation_steps = 2*8

# this makes total number of tokens be 500B
learning_rate = 6e-4
max_iters = 20000
lr_decay_iters = 500000

# eval stuff
eval_interval = 1000
save_interval = 10000
eval_iters = 96
log_interval = 10


order = [846, 277, 451, 87, 776, 719, 142, 487, 318, 101, 871, 481, 327, 635, 982, 836, 706, 888, 490, 418, 4, 609, 73, 567, 671, 943, 670, 986, 287, 745, 896, 545, 119, 392, 773, 504, 570, 769, 729, 329, 176, 420, 958, 157, 306, 805, 621, 181, 358, 342, 917, 215, 180, 377, 408, 44, 803, 938, 521, 924, 603, 752, 592, 432, 852, 137, 211, 218, 178, 662, 718, 870, 913, 1, 923, 136, 458, 434, 125, 764, 89, 243, 1016, 1010, 414, 216, 124, 198, 876, 522, 899, 994, 911, 39, 88, 799, 859, 967, 660, 33, 293, 55, 775, 536, 880, 488, 118, 734, 177, 960, 388, 267, 694, 220, 470, 732, 559, 85, 499, 423, 605, 283, 541, 475, 370, 366, 677, 480, 123, 209, 234, 701, 139, 872, 975, 359, 333, 352, 463, 477, 200, 363, 225, 971, 144, 831, 356, 828, 221, 367, 639, 506, 113, 997, 34, 676, 345, 141, 847, 396, 542, 844, 569, 454, 469, 723, 237, 641, 36, 725, 330, 93, 117, 790, 241, 763, 371, 232, 765, 1001, 520, 516, 116, 814, 281, 659, 364, 336, 509, 977, 801, 450, 957, 35, 795, 268, 966, 280, 816, 721, 313, 151, 271, 53, 936, 952, 909, 980, 549, 651, 104, 224, 210, 457, 374, 652, 875, 544, 586, 67, 741, 362, 185, 511, 325, 730, 689, 355, 347, 485, 921, 107, 174, 594, 963, 601, 920, 724, 863, 613, 69, 285, 953, 202, 133, 903, 56, 105, 273, 937, 925, 5, 445, 681, 632, 683, 922, 826, 602, 1007, 154, 134, 578, 530, 182, 839, 314, 378, 682, 698, 1002, 696, 289, 935, 862, 525, 664, 514, 879, 1017, 845, 346, 150, 585, 244, 479, 482, 568, 227, 808, 884, 173, 341, 94, 942, 633, 66, 77, 183, 944, 927, 902, 315, 162, 505, 508, 7, 459, 266, 305, 42, 262, 785, 121, 557, 230, 48, 229, 985, 546, 584, 510, 328, 292, 476, 829, 708, 675, 316, 74, 697, 299, 411, 360, 873, 312, 286, 153, 335, 882, 753, 759, 988, 389, 233, 384, 835, 455, 472, 556, 365, 688, 700, 892, 637, 496, 323, 71, 143, 907, 737, 932, 497, 235, 618, 208, 906, 576, 837, 8, 444, 631, 26, 619, 643, 539, 750, 678, 128, 810, 45, 427, 448, 614, 865, 996, 272, 429, 761, 930, 945, 416, 821, 207, 627, 402, 6, 456, 588, 350, 64, 833, 442, 257, 547, 189, 413, 166, 855, 987, 934, 758, 406, 179, 974, 926, 322, 853, 256, 634, 577, 494, 728, 276, 990, 68, 768, 240, 440, 532, 433, 478, 417, 199, 205, 890, 304, 91, 28, 993, 140, 1018, 868, 858, 715, 589, 99, 818, 565, 912, 797, 18, 317, 628, 115, 638, 787, 400, 449, 610, 939, 228, 684, 649, 824, 668, 394, 297, 361, 573, 160, 80, 380, 275, 840, 622, 995, 972, 30, 259, 781, 946, 954, 238, 474, 332, 647, 747, 59, 446, 733, 16, 188, 163, 854, 439, 550, 278, 591, 843, 531, 786, 261, 165, 21, 412, 575, 186, 263, 563, 962, 72, 711, 426, 415, 460, 484, 692, 722, 617, 38, 784, 92, 127, 290, 834, 428, 1014, 138, 1004, 368, 527, 75, 666, 1003, 399, 703, 20, 716, 679, 690, 796, 132, 70, 976, 501, 754, 798, 956, 245, 905, 108, 524, 462, 193, 749, 120, 806, 194, 65, 604, 817, 973, 498, 804, 15, 1019, 214, 302, 900, 41, 515, 989, 560, 258, 395, 387, 574, 149, 27, 3, 291, 461, 908, 848, 443, 674, 523, 169, 264, 246, 540, 379, 78, 391, 1000, 961, 554, 403, 79, 483, 702, 146, 61, 22, 894, 713, 436, 624, 1013, 788, 398, 502, 435, 254, 947, 0, 279, 340, 612, 184, 616, 382, 951, 842, 743, 782, 774, 112, 895, 841, 129, 999, 543, 353, 555, 331, 964, 52, 867, 252, 495, 714, 979, 337, 486, 767, 533, 625, 12, 653, 409, 789, 615, 231, 467, 260, 665, 812, 386, 827, 369, 1005, 81, 239, 551, 236, 90, 948, 383, 100, 187, 219, 96, 1006, 196, 553, 955, 800, 672, 437, 762, 376, 126, 581, 148, 29, 709, 518, 274, 889, 114, 856, 571, 10, 699, 14, 881, 746, 822, 933, 298, 122, 62, 311, 815, 1022, 735, 135, 811, 680, 206, 777, 84, 1015, 303, 308, 288, 898, 663, 667, 693, 877, 878, 704, 866, 642, 558, 212, 608, 959, 393, 247, 650, 802, 249, 950, 222, 344, 1021, 58, 295, 626, 204, 809, 401, 493, 2, 838, 794, 791, 170, 915, 983, 928, 338, 63, 452, 167, 390, 636, 526, 748, 929, 620, 897, 998, 269, 931, 823, 757, 673, 832, 654, 223, 770, 255, 885, 168, 404, 740, 373, 629, 13, 738, 375, 644, 731, 381, 705, 742, 548, 319, 9, 301, 25, 321, 597, 869, 940, 857, 192, 372, 357, 109, 780, 910, 324, 669, 158, 600, 147, 861, 656, 751, 172, 1023, 405, 949, 707, 1012, 914, 778, 339, 424, 410, 1009, 492, 744, 901, 106, 851, 756, 348, 583, 970, 60, 595, 655, 83, 265, 710, 874, 419, 326, 891, 755, 695, 919, 566, 270, 864, 191, 685, 397, 535, 623, 453, 422, 86, 739, 421, 491, 11, 562, 918, 300, 611, 82, 820, 294, 981, 50, 473, 40, 468, 51, 978, 984, 658, 425, 161, 431, 887, 793, 538, 893, 407, 97, 727, 561, 349, 992, 49, 830, 779, 580, 529, 190, 596, 441, 640, 466, 849, 657, 489, 197, 598, 528, 110, 76, 646, 203, 296, 850, 687, 24, 717, 156, 720, 819, 438, 320, 519, 171, 534, 582, 503, 579, 513, 783, 17, 343, 23, 464, 771, 309, 772, 447, 37, 242, 883, 43, 726, 131, 354, 904, 648, 736, 792, 807, 95, 572, 282, 590, 111, 517, 47, 686, 500, 599, 248, 593, 175, 712, 430, 152, 607, 965, 552, 1020, 1008, 825, 164, 813, 32, 564, 159, 587, 57, 968, 284, 916, 31, 155, 606, 251, 760, 213, 351, 766, 19, 630, 250, 226, 991, 253, 130, 103, 969, 537, 1011, 691, 645, 217, 886, 54, 661, 307, 145, 512, 310, 46, 860, 102, 201, 195, 507, 385, 941, 465, 98, 334, 471]