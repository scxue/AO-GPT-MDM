# config for training GPT-2 (124M) down to very nice loss of ~2.85 on 1 node of 8X A100 40GB
# launch as the following (e.g. in a screen session) and wait ~5 days:
# $ torchrun --standalone --nproc_per_node=8 train.py config/train_gpt2.py

# Model size
n_layer = 12
n_head = 12
n_embd = 768
model_type = 'AdaLN6_NoRep_cond_128_trunc_qknorm'

# I/O
out_dir = 'order_ckpt/124M-order3'
wandb_log = True
wandb_project = 'AOGPT'
wandb_run_name= 'AOGPT-124M-order3'

# Bias
bias = True

# Dropout
dropout = 0.0

# EMA
ema_rate = 1 - 1e-4

# weight decay
weight_decay = 5e-2

# beta2
beta2 = 0.95

# these make the total batch size be ~0.5M
# 32 batch size * 1024 block size * 2 gradaccum * 8 GPUs = 524,288
batch_size = 32
block_size = 1024
gradient_accumulation_steps = 2*8

# this makes total number of tokens be 500B
learning_rate = 6e-4
max_iters = 20000
lr_decay_iters = 500000

# eval stuff
eval_interval = 1000
save_interval = 10000
eval_iters = 96
log_interval = 10


order = [740, 764, 750, 274, 342, 573, 998, 623, 535, 896, 165, 414, 603, 487, 812, 39, 480, 991, 649, 92, 957, 350, 327, 948, 810, 580, 477, 134, 665, 776, 486, 874, 278, 542, 299, 483, 103, 937, 340, 227, 666, 869, 922, 616, 63, 574, 385, 783, 681, 895, 941, 183, 510, 775, 543, 331, 285, 588, 995, 439, 587, 864, 1006, 960, 397, 469, 33, 838, 826, 592, 927, 548, 923, 123, 699, 426, 511, 360, 684, 266, 643, 601, 994, 737, 602, 527, 296, 225, 887, 878, 234, 398, 213, 997, 253, 661, 64, 455, 60, 886, 717, 738, 346, 65, 900, 663, 57, 30, 772, 875, 698, 259, 539, 550, 492, 811, 701, 778, 46, 884, 269, 326, 970, 287, 388, 436, 412, 192, 807, 311, 310, 479, 429, 544, 187, 693, 373, 1003, 354, 204, 768, 562, 558, 634, 372, 819, 173, 824, 499, 733, 773, 131, 255, 728, 443, 866, 127, 846, 151, 351, 286, 715, 435, 1008, 614, 791, 138, 621, 329, 408, 882, 162, 530, 821, 850, 303, 593, 576, 171, 1016, 1022, 790, 917, 589, 459, 575, 930, 624, 218, 344, 506, 478, 462, 606, 12, 1011, 378, 905, 135, 706, 797, 413, 687, 302, 889, 862, 652, 98, 55, 752, 516, 722, 9, 714, 347, 879, 967, 1009, 420, 618, 520, 120, 769, 305, 272, 498, 825, 140, 711, 538, 230, 935, 86, 670, 943, 688, 851, 139, 100, 295, 485, 132, 449, 90, 749, 212, 787, 841, 475, 609, 394, 208, 297, 460, 75, 636, 540, 377, 307, 673, 105, 21, 494, 362, 356, 27, 625, 318, 215, 188, 648, 411, 391, 180, 348, 767, 99, 524, 387, 933, 147, 157, 14, 718, 549, 106, 291, 493, 172, 678, 482, 174, 52, 466, 383, 612, 702, 338, 689, 730, 934, 18, 993, 848, 25, 368, 245, 938, 185, 61, 355, 164, 667, 363, 137, 304, 406, 444, 484, 809, 101, 860, 15, 928, 726, 500, 561, 519, 405, 1014, 514, 370, 759, 972, 330, 842, 1012, 68, 635, 969, 504, 604, 590, 4, 954, 989, 380, 35, 491, 214, 198, 1000, 136, 294, 78, 490, 1010, 248, 229, 794, 880, 76, 236, 440, 149, 898, 20, 617, 564, 155, 42, 784, 741, 325, 696, 393, 782, 228, 674, 555, 1015, 525, 595, 599, 940, 534, 168, 121, 54, 545, 901, 908, 279, 425, 358, 630, 653, 424, 852, 505, 219, 585, 945, 244, 956, 1002, 71, 899, 800, 891, 400, 222, 512, 5, 489, 402, 31, 334, 522, 868, 115, 361, 758, 951, 431, 736, 189, 292, 110, 51, 381, 572, 392, 37, 676, 258, 963, 739, 523, 205, 820, 70, 332, 966, 936, 582, 642, 317, 646, 911, 268, 858, 3, 1013, 239, 657, 835, 1018, 662, 366, 206, 40, 660, 273, 777, 786, 774, 396, 885, 118, 622, 973, 404, 551, 796, 980, 91, 554, 108, 395, 73, 925, 746, 85, 571, 804, 536, 6, 235, 828, 918, 679, 328, 1017, 102, 41, 24, 1020, 0, 847, 337, 107, 345, 628, 629, 454, 817, 19, 721, 982, 77, 873, 762, 837, 389, 256, 863, 94, 93, 515, 195, 965, 632, 843, 683, 178, 641, 840, 563, 22, 686, 894, 275, 507, 122, 410, 82, 626, 704, 668, 38, 639, 464, 557, 376, 919, 799, 159, 264, 893, 854, 309, 202, 211, 240, 789, 233, 939, 902, 467, 177, 785, 260, 833, 156, 84, 757, 382, 705, 316, 453, 7, 367, 723, 806, 456, 221, 832, 468, 34, 748, 89, 694, 977, 952, 250, 261, 644, 611, 117, 2, 502, 23, 813, 950, 959, 645, 160, 727, 822, 315, 130, 531, 333, 170, 447, 857, 978, 650, 474, 45, 597, 298, 114, 823, 685, 16, 374, 877, 839, 58, 72, 637, 476, 912, 600, 430, 451, 924, 829, 223, 113, 375, 883, 251, 119, 56, 844, 276, 175, 320, 371, 109, 745, 203, 830, 129, 314, 67, 323, 144, 763, 892, 703, 675, 724, 907, 161, 415, 379, 992, 999, 655, 779, 532, 442, 631, 801, 154, 288, 263, 780, 865, 596, 186, 836, 29, 79, 182, 197, 734, 914, 433, 446, 664, 289, 876, 581, 729, 313, 257, 1001, 28, 659, 241, 720, 890, 181, 434, 497, 983, 570, 990, 306, 153, 975, 909, 409, 770, 319, 920, 559, 133, 152, 283, 988, 537, 615, 682, 518, 503, 32, 432, 384, 692, 856, 471, 944, 633, 47, 445, 210, 987, 353, 792, 853, 747, 95, 141, 461, 438, 13, 526, 126, 59, 8, 87, 417, 871, 903, 996, 849, 834, 81, 349, 145, 111, 196, 761, 146, 755, 691, 201, 732, 743, 913, 386, 962, 336, 176, 481, 578, 577, 470, 677, 651, 364, 428, 403, 50, 193, 231, 594, 450, 252, 568, 888, 501, 194, 232, 224, 496, 798, 620, 932, 209, 488, 949, 1019, 407, 897, 805, 53, 365, 69, 725, 166, 452, 567, 74, 335, 247, 607, 242, 788, 36, 760, 803, 341, 613, 881, 301, 583, 48, 793, 369, 751, 66, 280, 1023, 143, 293, 916, 472, 765, 976, 870, 638, 267, 1004, 216, 598, 781, 104, 719, 423, 290, 710, 753, 300, 226, 128, 831, 904, 509, 262, 647, 390, 62, 246, 49, 528, 281, 731, 184, 915, 150, 416, 658, 282, 427, 1005, 243, 190, 1021, 845, 473, 964, 546, 552, 610, 339, 672, 713, 265, 744, 569, 271, 83, 322, 270, 565, 359, 457, 929, 979, 142, 958, 700, 735, 654, 448, 640, 827, 169, 533, 942, 802, 521, 437, 971, 754, 343, 357, 237, 814, 771, 80, 680, 284, 695, 712, 10, 465, 872, 148, 808, 495, 191, 158, 707, 742, 254, 508, 277, 608, 984, 815, 981, 179, 163, 671, 961, 112, 619, 529, 88, 931, 766, 579, 910, 401, 200, 553, 124, 955, 584, 463, 441, 1, 352, 756, 421, 656, 566, 517, 238, 26, 199, 690, 96, 560, 986, 220, 324, 697, 985, 946, 422, 968, 708, 605, 1007, 418, 458, 953, 167, 556, 217, 627, 926, 43, 44, 249, 816, 709, 419, 513, 855, 591, 795, 859, 17, 947, 541, 867, 321, 97, 818, 669, 312, 906, 11, 974, 716, 586, 399, 547, 861, 308, 921, 207, 116, 125]